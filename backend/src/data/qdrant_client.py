import os\n# Code generated by Claude Code.\n# Co-Authored-By: Claude <noreply@anthropic.com>\nfrom qdrant_client import QdrantClient\nfrom qdrant_client.http.models import Distance, VectorParams\nfrom backend.src.utils.logging import get_logger\n\nlogger = get_logger(__name__)\n\nCOLLECTION_NAME = \"book_content\"\n\ndef get_qdrant_client() -> QdrantClient:\n    qdrant_host = os.getenv(\"QDRANT_HOST\")\n    qdrant_api_key = os.getenv(\"QDRANT_API_KEY\")\n\n    if not qdrant_host or not qdrant_api_key:\n        logger.error(\"QDRANT_HOST and QDRANT_API_KEY must be set in environment variables\")\n        raise ValueError(\"Qdrant credentials not set\")\n\n    client = QdrantClient(\n        host=qdrant_host,\n        api_key=qdrant_api_key,\n    )\n    logger.info(\"Connected to Qdrant\ пе\")\n    return client\n\ndef ensure_collection_exists(client: QdrantClient):\n    collections = client.get_collections().collections\n    if COLLECTION_NAME not in [c.name for c in collections]:\n        logger.info(f\"Creating Qdrant collection: {COLLECTION_NAME}\")\n        client.create_collection(\n            collection_name=COLLECTION_NAME,\n            vectors_config=VectorParams(size=1536, distance=Distance.COSINE),  # OpenAI embeddings size\n        )\n        logger.info(f\"Collection {COLLECTION_NAME} created.\")\n    else:\n        logger.info(f\"Collection {COLLECTION_NAME} already exists.\")